(function(a){a.fn.marquee=function(b){return this.each(function(){var Z=a.extend({},a.fn.marquee.defaults,b),Y=a(this),X,T,H,x,S,V=3,i="animation-play-state",P=!1,G=function(h,g,m){for(var k=["webkit","moz","MS","o",""],l=0;l<k.length;l++){k[l]||(g=g.toLowerCase()),h.addEventListener(k[l]+g,m,!1)}},s=function(e){var d=[],g;for(g in e){e.hasOwnProperty(g)&&d.push(g+":"+e[g])}d.push();return"{"+d.join(",")+"}"},O={pause:function(){P&&Z.allowCss3Support?X.css(i,"paused"):a.fn.pause&&X.pause();Y.data("runningStatus","paused");Y.trigger("paused")},resume:function(){P&&Z.allowCss3Support?X.css(i,"running"):a.fn.resume&&X.resume();Y.data("runningStatus","resumed");Y.trigger("resumed")},toggle:function(){O["resumed"==Y.data("runningStatus")?"pause":"resume"]()},destroy:function(){clearTimeout(Y.timer);Y.find("*").andSelf().unbind();Y.html(Y.find(".js-marquee:first").html())}};if("string"===typeof b){a.isFunction(O[b])&&(X||(X=Y.find(".js-marquee-wrapper")),!0===Y.data("css3AnimationIsSupported")&&(P=!0),O[b]())}else{var o;a.each(Z,function(g,e){o=Y.attr("data-"+g);if("undefined"!==typeof o){switch(o){case"true":o=!0;break;case"false":o=!1}Z[g]=o}});Z.speed&&(Z.duration=Z.speed*parseInt(Y.width(),10));x="up"==Z.direction||"down"==Z.direction;Z.gap=Z.duplicated?parseInt(Z.gap):0;Y.wrapInner('<div class="js-marquee"></div>');var R=Y.find(".js-marquee").css({"margin-right":Z.gap,"float":"left"});Z.duplicated&&R.clone(!0).appendTo(Y);Y.wrapInner('<div style="width:100000px" class="js-marquee-wrapper"></div>');X=Y.find(".js-marquee-wrapper");if(x){var Q=Y.height();X.removeAttr("style");Y.height(Q);Y.find(".js-marquee").css({"float":"none","margin-bottom":Z.gap,"margin-right":0});Z.duplicated&&Y.find(".js-marquee:last").css({"margin-bottom":0});var M=Y.find(".js-marquee:first").height()+Z.gap;Z.startVisible&&!Z.duplicated?(Z._completeDuration=(parseInt(M,10)+parseInt(Q,10))/parseInt(Q,10)*Z.duration,Z.duration*=parseInt(M,10)/parseInt(Q,10)):Z.duration*=(parseInt(M,10)+parseInt(Q,10))/parseInt(Q,10)}else{S=Y.find(".js-marquee:first").width()+Z.gap,T=Y.width(),Z.startVisible&&!Z.duplicated?(Z._completeDuration=(parseInt(S,10)+parseInt(T,10))/parseInt(T,10)*Z.duration,Z.duration*=parseInt(S,10)/parseInt(T,10)):Z.duration*=(parseInt(S,10)+parseInt(T,10))/parseInt(T,10)}Z.duplicated&&(Z.duration/=2);if(Z.allowCss3Support){var R=document.body||document.createElement("div"),U="marqueeAnimation-"+Math.floor(10000000*Math.random()),N=["Webkit","Moz","O","ms","Khtml"],L="animation",W="",K="";R.style.animation&&(K="@keyframes "+U+" ",P=!0);if(!1===P){for(var f=0;f<N.length;f++){if(void 0!==R.style[N[f]+"AnimationName"]){R="-"+N[f].toLowerCase()+"-";L=R+L;i=R+i;K="@"+R+"keyframes "+U+" ";P=!0;break}}}P&&(W=U+" "+Z.duration/1000+"s "+Z.delayBeforeStart/1000+"s infinite "+Z.css3easing,Y.data("css3AnimationIsSupported",!0))}var J=function(){X.css("margin-top","up"==Z.direction?Q+"px":"-"+M+"px")},I=function(){X.css("margin-left","left"==Z.direction?T+"px":"-"+S+"px")};Z.duplicated?(x?Z.startVisible?X.css("margin-top",0):X.css("margin-top","up"==Z.direction?Q+"px":"-"+(2*M-Z.gap)+"px"):Z.startVisible?X.css("margin-left",0):X.css("margin-left","left"==Z.direction?T+"px":"-"+(2*S-Z.gap)+"px"),Z.startVisible||(V=1)):Z.startVisible?V=2:x?J():I();var j=function(){Z.duplicated&&(1===V?(Z._originalDuration=Z.duration,Z.duration=x?"up"==Z.direction?Z.duration+Q/(M/Z.duration):2*Z.duration:"left"==Z.direction?Z.duration+T/(S/Z.duration):2*Z.duration,W&&(W=U+" "+Z.duration/1000+"s "+Z.delayBeforeStart/1000+"s "+Z.css3easing),V++):2===V&&(Z.duration=Z._originalDuration,W&&(U+="0",K=a.trim(K)+"0 ",W=U+" "+Z.duration/1000+"s 0s infinite "+Z.css3easing),V++));x?Z.duplicated?(2<V&&X.css("margin-top","up"==Z.direction?0:"-"+M+"px"),H={"margin-top":"up"==Z.direction?"-"+M+"px":0}):Z.startVisible?2===V?(W&&(W=U+" "+Z.duration/1000+"s "+Z.delayBeforeStart/1000+"s "+Z.css3easing),H={"margin-top":"up"==Z.direction?"-"+M+"px":Q+"px"},V++):3===V&&(Z.duration=Z._completeDuration,W&&(U+="0",K=a.trim(K)+"0 ",W=U+" "+Z.duration/1000+"s 0s infinite "+Z.css3easing),J()):(J(),H={"margin-top":"up"==Z.direction?"-"+X.height()+"px":Q+"px"}):Z.duplicated?(2<V&&X.css("margin-left","left"==Z.direction?0:"-"+S+"px"),H={"margin-left":"left"==Z.direction?"-"+S+"px":0}):Z.startVisible?2===V?(W&&(W=U+" "+Z.duration/1000+"s "+Z.delayBeforeStart/1000+"s "+Z.css3easing),H={"margin-left":"left"==Z.direction?"-"+S+"px":T+"px"},V++):3===V&&(Z.duration=Z._completeDuration,W&&(U+="0",K=a.trim(K)+"0 ",W=U+" "+Z.duration/1000+"s 0s infinite "+Z.css3easing),I()):(I(),H={"margin-left":"left"==Z.direction?"-"+S+"px":T+"px"});Y.trigger("beforeStarting");if(P){X.css(L,W);var c=K+" { 100%  "+s(H)+"}",d=X.find("style");0!==d.length?d.filter(":last").html(c):X.append("<style>"+c+"</style>");G(X[0],"AnimationIteration",function(){Y.trigger("finished")});G(X[0],"AnimationEnd",function(){j();Y.trigger("finished")})}else{X.animate(H,Z.duration,Z.easing,function(){Y.trigger("finished");Z.pauseOnCycle?Y.timer=setTimeout(j,Z.delayBeforeStart):j()})}Y.data("runningStatus","resumed")};Y.bind("pause",O.pause);Y.bind("resume",O.resume);Z.pauseOnHover&&Y.bind("mouseenter mouseleave",O.toggle);P&&Z.allowCss3Support?j():Y.timer=setTimeout(j,Z.delayBeforeStart)}})};a.fn.marquee.defaults={allowCss3Support:!0,css3easing:"linear",easing:"linear",delayBeforeStart:1000,direction:"left",duplicated:!1,duration:5000,gap:20,pauseOnCycle:!1,pauseOnHover:!1,startVisible:!1}})(jQuery);